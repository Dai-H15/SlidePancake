(()=>{"use strict";(()=>{const e=document.location.pathname;if(null!=e.match(/\/courses\/\d{4}\/[A-Z, a-z, 0-9]+\/[a-z, 0-9]+\/\d+/)){console.log("The path contains /courses/(year)/(course name)/(material name)/(page number)/");let e=document.getElementsByTagName("iframe");if(console.log(e.length),e.length>0)for(let t=0;t<e.length;t++)if(e[t].src.includes("presentation")){let n=document.getElementsByClassName("pad-block")[t],a=document.createElement("a");a.className="btn btn-dark btn-sm",a.innerText="Slide Pancake",a.href=e[t].src,a.target="_blank",n.appendChild(a)}}else e.includes("presentation")&&(()=>{let e=document.getElementsByTagName("svg"),t=document.querySelectorAll('[class$="-caption"]')[0],n=document.getElementsByClassName("punch-viewer-content")[0],a=t.getAttribute("aria-setsize"),l="",i="",o=trustedTypes.createPolicy("forceInner",{createHTML:e=>e});confirm("SlidePancakeからの通知\nスライドの複製を開始しますか？\n⚠️著作権に細心の注意を払い、個人用途にとどめてください。\nSlidePancake作者は一切の責任を負いません。")&&function c(r){let s=document.createElement("div"),m=document.createElement("div");s.style="break-after: page; width: 90%;break-inside: avoid; margin-bottom: 40px;border-bottom: solid gray;padding-bottom: 40px;";let d=e[0].outerHTML,u="";if(r&&(m.style="width: 70%;float: right;"),m.innerHTML=o.createHTML(d),s.appendChild(m),r){let e=document.getElementsByTagName("g");for(const t of e)null!=t.ariaLabel&&(u+=t.ariaLabel+"\t");if(""!=u){let e=document.createElement("small");e.style="width: 20%;float: left;margin: 20px;",e.innerText=u,s.appendChild(e)}}s.childNodes.length>0&&(l+=s.outerHTML),(i=t.getAttribute("aria-posinset"))==a?(document.write(o.createHTML(l)),document.body.style="display: flex;flex-direction: column;align-items: center;",confirm("PDFとして保存/印刷を行いますか？")&&window.print()):(n.click(),setTimeout(c,10,r))}(confirm("スライドに埋め込まれた文章も一緒に出力しますか？\nスライド画像のみ出力する場合は'キャンセル'を選択してください。"))})()})()})();